<!DOCTYPE html>
<html lang="zh-Hant">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="./img/favicon.ico" type="image/x-icon" />
    <link rel="Shortcut Icon" href="./img/favicon.ico" type="image/x-icon" />
    <script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.js'></script>


    <link rel="stylesheet" href="./css/style.css">
    <link rel="stylesheet" href="./fontawesome/css/all.css">
    <title>海中日子 | 購物商城</title>
</head>

<body class="shop">
    @@include('./layout/header.html')
    <div class="lightbox-block1">
        <div class="lightbox1">
            <div class="button_closeBox1">
                <button type="button" class="btn_modal_close">✖</button>
            </div>
            <h3></h3>
            <p>。</p>
        </div>
    </div>

    <div class="shopH2">
        <h2>潛水商城</h2>
    </div>

    <div class="itemType">
        <ul>
            <li>面鏡</li>
            <li>潛水錶</li>
            <li>手套</li>
            <li>蛙鞋</li>
        </ul>
    </div>

    <div class="foojun">
    </div>

    @@include('./layout/footer.html')
    <script src="./js/shop.js"></script>

    <script>
        function doFirst() {

            let heart = document.getElementsByClassName('fa-heart');

            for (let k = 0; k < heart.length; k++) {
                heart[k].addEventListener('click', redFill);
            }
            function redFill(e) {
                if (e.target.style.color == 'red') {
                    e.target.style.color = 'white';
                } else {
                    e.target.style.color = 'red';
                }
            }


        }
        window.addEventListener('load', doFirst);
    </script>

    <script>
        $(document).ready(function () {
            $.ajax({
                url: 'shopnew.php',
                dataType: 'JSON',
                type: 'GET',
                success(data) {
                    console.log(data);
                    console.log(data.length);
                    for (let i = 0; i < data.length; i += 1) {
                        $('.foojun').append(`     
                        <div class="art">
                            <span class="itemName">${data[i].itemName}</span>
                            <div class="item">
                                <img src="./img/shop/${data[i].itemImg}" alt="">
                            </div>
                            <span class="NT">NT$${data[i].itemPrice}</span>
    
                            <div class="shopBtn">
                                <div class="bubbleBtn detail mainBtn_1">
                                    <svg xmlns="http://www.w3.org/2000/svg" version="1.1" class="goo">
                                        <defs>
                                            <filter id="goo">
                                                <feGaussianBlur in="SourceGraphic" stdDeviation="10" result="blur" />
                                                <feColorMatrix in="blur" mode="matrix"
                                                    values="1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 19 -9" result="goo" />
                                                <feComposite in="SourceGraphic" in2="goo" />
                                            </filter>
                                        </defs>
                                    </svg>
    
                                    <span class="button--bubble__container">
                                        <a href="#campaign" class="button button--bubble">
                                            查看詳情
                                        </a>
                                        <span class="button--bubble__effect-container">
                                            <span class="circle top-left"></span>
                                            <span class="circle top-left"></span>
                                            <span class="circle top-left"></span>
    
                                            <span class="button effect-button"></span>
    
                                            <span class="circle bottom-right"></span>
                                            <span class="circle bottom-right"></span>
                                            <span class="circle bottom-right"></span>
                                        </span>
                                    </span>
                                </div>
                                <div class="bubbleBtn addCart" id="${data[i].itemId}">
                                    <input type="hidden" value="${data[i].itemName}|${data[i].itemImg}|${data[i].itemPrice}">
                                    <svg xmlns="http://www.w3.org/2000/svg" version="1.1" class="goo">
                                        <defs>
                                            <filter id="goo">
                                                <feGaussianBlur in="SourceGraphic" stdDeviation="10" result="blur" />
                                                <feColorMatrix in="blur" mode="matrix"
                                                    values="1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 19 -9" result="goo" />
                                                <feComposite in="SourceGraphic" in2="goo" />
                                            </filter>
                                        </defs>
                                    </svg>
    
                                    <span class="button--bubble__container">
                                        <a href="#campaign" class="button button--bubble">
                                            加入購物車
                                        </a>
                                        <span class="button--bubble__effect-container">
                                            <span class="circle top-left"></span>
                                            <span class="circle top-left"></span>
                                            <span class="circle top-left"></span>
    
                                            <span class="button effect-button"></span>
    
                                            <span class="circle bottom-right"></span>
                                            <span class="circle bottom-right"></span>
                                            <span class="circle bottom-right"></span>
                                        </span>
                                    </span>
                                </div>
                            </div>
                            <i class="fas fa-heart"></i>

                            <div class="lightbox-block1">
                                <div class="lightbox1">
                                    <div class="button_closeBox1">
                                        <button type="button" class="btn_modal_close">✖</button>
                                    </div>
                                    <h3>水中看得清</h3>
                                    <p>裝備裝備</p>
                                </div>
                            </div>
                        </div>

                        `);
                    }
                    
                    bubble();
                    detail();
                },
            });

            function detail(){
                // 5-1  查看詳情
                // 開啟 Modal 彈跳視窗
                var mainButton = document.getElementsByClassName("mainBtn_1");
                var lightbox = document.getElementsByClassName("lightbox-block1")[0];

                var lightboxH3 = lightbox.getElementsByTagName("h3")[0];
                var lightboxP = lightbox.getElementsByTagName("p")[0];

                for (var i = 0; i < mainButton.length; i++) {
                    mainButton[i].addEventListener("click", openLightbox, false);
                }

                function openLightbox() {
                    lightbox.classList.add("-openbox");
                    console.log(this)
                    var parent = this.parentNode.parentNode;

                    let title = parent.children[0].innerText;

                    lightboxH3.innerHTML = title;
                    lightboxP.innerHTML = title;
                }

                // $(".mainBtn_1").on("click", function(){
                //     $(".lightbox-block1").addClass("-openbox");
                // });

                // 關閉 Modal
                $(".btn_modal_close").on("click", function () {
                    $(".lightbox-block1").addClass("-opacity-zero");
                    // 設定隔一秒後，移除相關 class
                    setTimeout(function () {
                        $(".lightbox-block1").removeClass("-openbox -opacity-zero");
                    }, 1000);
                });
            }




            function bubble() {
                //bubbleBtn
                $('.button--bubble').each(function () {
                    var $circlesTopLeft = $(this).parent().find('.circle.top-left');
                    var $circlesBottomRight = $(this).parent().find('.circle.bottom-right');

                    var tl = new TimelineMax();
                    var tl2 = new TimelineMax();

                    var btTl = new TimelineMax({
                        paused: true
                    });

                    tl.to($circlesTopLeft, 1.2, {
                        x: -25,
                        y: -25,
                        scaleY: 2,
                        ease: SlowMo.ease.config(0.1, 0.7, false)
                    });
                    tl.to($circlesTopLeft.eq(0), 0.1, {
                        scale: 0.2,
                        x: '+=6',
                        y: '-=2'
                    });
                    tl.to($circlesTopLeft.eq(1), 0.1, {
                        scaleX: 1,
                        scaleY: 0.8,
                        x: '-=10',
                        y: '-=7'
                    }, '-=0.1');
                    tl.to($circlesTopLeft.eq(2), 0.1, {
                        scale: 0.2,
                        x: '-=15',
                        y: '+=6'
                    }, '-=0.1');
                    tl.to($circlesTopLeft.eq(0), 1, {
                        scale: 0,
                        x: '-=5',
                        y: '-=15',
                        opacity: 0
                    });
                    tl.to($circlesTopLeft.eq(1), 1, {
                        scaleX: 0.4,
                        scaleY: 0.4,
                        x: '-=10',
                        y: '-=10',
                        opacity: 0
                    }, '-=1');
                    tl.to($circlesTopLeft.eq(2), 1, {
                        scale: 0,
                        x: '-=15',
                        y: '+=5',
                        opacity: 0
                    }, '-=1');

                    var tlBt1 = new TimelineMax();
                    var tlBt2 = new TimelineMax();

                    tlBt1.set($circlesTopLeft, {
                        x: 0,
                        y: 0,
                        rotation: -45
                    });
                    tlBt1.add(tl);

                    tl2.set($circlesBottomRight, {
                        x: 0,
                        y: 0
                    });
                    tl2.to($circlesBottomRight, 1.1, {
                        x: 30,
                        y: 30,
                        ease: SlowMo.ease.config(0.1, 0.7, false)
                    });
                    tl2.to($circlesBottomRight.eq(0), 0.1, {
                        scale: 0.2,
                        x: '-=6',
                        y: '+=3'
                    });
                    tl2.to($circlesBottomRight.eq(1), 0.1, {
                        scale: 0.8,
                        x: '+=7',
                        y: '+=3'
                    }, '-=0.1');
                    tl2.to($circlesBottomRight.eq(2), 0.1, {
                        scale: 0.2,
                        x: '+=15',
                        y: '-=6'
                    }, '-=0.2');
                    tl2.to($circlesBottomRight.eq(0), 1, {
                        scale: 0,
                        x: '+=5',
                        y: '+=15',
                        opacity: 0
                    });
                    tl2.to($circlesBottomRight.eq(1), 1, {
                        scale: 0.4,
                        x: '+=7',
                        y: '+=7',
                        opacity: 0
                    }, '-=1');
                    tl2.to($circlesBottomRight.eq(2), 1, {
                        scale: 0,
                        x: '+=15',
                        y: '-=5',
                        opacity: 0
                    }, '-=1');

                    tlBt2.set($circlesBottomRight, {
                        x: 0,
                        y: 0,
                        rotation: 45
                    });
                    tlBt2.add(tl2);

                    btTl.add(tlBt1);
                    btTl.to($(this).parent().find('.button.effect-button'), 0.8, {
                        scaleY: 1.1
                    }, 0.1);
                    btTl.add(tlBt2, 0.2);
                    btTl.to($(this).parent().find('.button.effect-button'), 1.8, {
                        scale: 1,
                        ease: Elastic.easeOut.config(1.2, 0.4)
                    }, 1.2);

                    btTl.timeScale(2.6);

                    $(this).on('mouseover', function () {
                        btTl.restart();
                    });
                });

            }
        });
    </script>

</body>

</html>